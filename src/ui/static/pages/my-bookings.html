<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Meus Agendamentos | Little's Petshop</title>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;500;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- Styles -->
  <link rel="stylesheet" href="../styles/global.css" />
  <link rel="stylesheet" href="../styles/components/feedback-modal.css" />
  <link rel="stylesheet" href="../styles/calendar-view.css" />
  
  <!-- Scripts -->
  <script src="/scripts/components/sidebar-component.js" type="module"></script>
  <script src="/scripts/pages/my-bookings-page.js" type="module"></script>
</head>
<body>

  <div class="dashboard-container">
    <!-- Sidebar Component -->
    <petshop-sidebar active="my-bookings"></petshop-sidebar>

    <!-- Main Content -->
    <main class="main-content">
      <div class="page-header">
        <div class="header-left">
          <h1 class="page-title">Meus Agendamentos</h1>
          <p class="page-subtitle">Clique em um horário vazio para agendar ou em um agendamento para ver detalhes</p>
        </div>
        <div class="header-actions">
          <div class="service-filter">
            <label for="serviceFilter">Filtrar por serviço:</label>
            <select id="serviceFilter">
              <option value="">Todos os serviços</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Calendar Section -->
      <div class="calendar-wrapper">
        <!-- Calendar Header -->
        <div class="calendar-top-bar">
          <div class="calendar-nav-section">
            <button class="btn-today" id="todayBtn">Hoje</button>
            <div class="nav-arrows">
              <button class="nav-arrow" id="prevWeek" aria-label="Semana anterior">
                <i data-lucide="chevron-left"></i>
              </button>
              <button class="nav-arrow" id="nextWeek" aria-label="Próxima semana">
                <i data-lucide="chevron-right"></i>
              </button>
            </div>
            <h2 class="calendar-period" id="calendarPeriod">Janeiro 2026</h2>
          </div>
          <div class="view-toggle">
            <button class="view-btn active" data-view="week">Semana</button>
            <button class="view-btn" data-view="month">Mês</button>
          </div>
        </div>

        <!-- Availability Legend -->
        <div class="availability-legend">
          <div class="legend-item">
            <span class="legend-color available"></span>
            <span>Disponível</span>
          </div>
          <div class="legend-item">
            <span class="legend-color booked"></span>
            <span>Agendado</span>
          </div>
          <div class="legend-item">
            <span class="legend-color unavailable"></span>
            <span>Indisponível</span>
          </div>
        </div>

        <!-- Week View Calendar -->
        <div class="calendar-container" id="weekView">
          <!-- Time column + 7 day columns -->
          <div class="calendar-header-row">
            <div class="time-gutter"></div>
            <div class="day-headers" id="dayHeaders">
              <!-- Day headers will be generated by JavaScript -->
            </div>
          </div>
          
          <div class="calendar-body">
            <div class="time-column" id="timeColumn">
              <!-- Time slots will be generated by JavaScript -->
            </div>
            <div class="days-grid" id="daysGrid">
              <!-- Day columns with events will be generated by JavaScript -->
            </div>
          </div>
        </div>

        <!-- Month View Calendar -->
        <div class="calendar-container month-view" id="monthView" style="display: none;">
          <div class="month-header-row">
            <div class="month-day-label">DOM</div>
            <div class="month-day-label">SEG</div>
            <div class="month-day-label">TER</div>
            <div class="month-day-label">QUA</div>
            <div class="month-day-label">QUI</div>
            <div class="month-day-label">SEX</div>
            <div class="month-day-label">SÁB</div>
          </div>
          <div class="month-grid" id="monthGrid">
            <!-- Month cells will be generated by JavaScript -->
          </div>
        </div>
      </div>

      <!-- Booking Modal - Create New Booking -->
      <div class="modal-overlay" id="bookingModal" style="display: none;">
        <div class="modal-content booking-modal">
          <div class="modal-header">
            <h3 class="modal-title">
              <i data-lucide="calendar-plus"></i>
              Novo Agendamento
            </h3>
            <button class="modal-close" id="closeBookingModal">
              <i data-lucide="x"></i>
            </button>
          </div>
          <div class="modal-body">
            <div class="booking-datetime-info">
              <div class="info-row">
                <i data-lucide="calendar"></i>
                <span id="selectedDate">-</span>
              </div>
              <div class="info-row">
                <i data-lucide="clock"></i>
                <span id="selectedTime">-</span>
              </div>
            </div>

            <form id="newBookingForm">
              <!-- Service Selection -->
              <div class="form-section">
                <label class="form-label">Serviço Disponível</label>
                <div class="services-list" id="availableServices">
                  <div class="loading-services">
                    <i data-lucide="loader"></i>
                    Carregando serviços...
                  </div>
                </div>
              </div>

              <!-- Pet Selection -->
              <div class="form-section">
                <label class="form-label">Selecione o Pet</label>
                <div class="pets-list" id="petsList">
                  <div class="loading-pets">
                    <i data-lucide="loader"></i>
                    Carregando pets...
                  </div>
                </div>
              </div>

              <!-- Price Display -->
              <div class="price-display" id="priceDisplay" style="display: none;">
                <div class="price-label">Valor do serviço:</div>
                <div class="price-value" id="bookingPrice">R$ 0,00</div>
              </div>

              <input type="hidden" id="selectedServiceId" name="jobId" />
              <input type="hidden" id="selectedPetId" name="petId" />
              <input type="hidden" id="bookingDateInput" name="bookingDate" />
              <input type="hidden" id="bookingTimeInput" name="bookingTime" />
            </form>
          </div>
          <div class="modal-footer">
            <button class="btn-secondary" id="cancelNewBooking">Cancelar</button>
            <button class="btn-primary" id="confirmNewBooking" disabled>
              <i data-lucide="check"></i>
              Confirmar Agendamento
            </button>
          </div>
        </div>
      </div>

      <!-- Event Details Modal -->
      <div class="modal-overlay" id="eventModal" style="display: none;">
        <div class="modal-content">
          <div class="modal-header">
            <h3 class="modal-title">Detalhes do Agendamento</h3>
            <button class="modal-close" id="closeModal">
              <i data-lucide="x"></i>
            </button>
          </div>
          <div class="modal-body" id="eventDetails">
            <!-- Event details will be populated by JavaScript -->
          </div>
          <div class="modal-footer">
            <button class="btn-secondary" id="cancelBookingBtn">
              <i data-lucide="x-circle"></i>
              Cancelar Agendamento
            </button>
          </div>
        </div>
      </div>

    </main>
  </div>

  <script>
    lucide.createIcons();
  </script>
</body>
</html>
